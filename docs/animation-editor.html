<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Animation & Attack Editor</title>
  <link rel="icon" href="./favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="./animation-editor.css">
</head>
<body>
  <main class="animation-editor">
    <section class="editor-preview">
      <div class="preview-stage">
        <canvas id="animationCanvas" width="720" height="460" aria-label="Animation preview"></canvas>
        <div class="preview-placeholder" id="previewPlaceholder">
          <p style="margin:0;">Timeline preview ready. Configure a move or attack on the right to view its pacing.</p>
          <p style="margin:8px 0 0 0;font-size:12px;">Real-time animation playback will arrive in a later updateâ€”the editor focuses on timing, sequence, and event data.</p>
        </div>
      </div>
      <div class="preview-stage pose-stage">
        <canvas id="poseCanvas" width="720" height="460" aria-label="Pose preview"></canvas>
        <div class="preview-placeholder" id="posePlaceholder">
          <p style="margin:0;">Select a move and pose to preview it with a fighter rig.</p>
          <p style="margin:8px 0 0 0;font-size:12px;">Choose a fighter on the right to inspect how offsets and angles look against real sprites.</p>
        </div>
      </div>
      <div class="timeline-panel">
        <div>
          <h2>Move Timeline</h2>
          <div id="moveTimeline" class="timeline" aria-live="polite"></div>
        </div>
        <div>
          <h2>Attack Sequence</h2>
          <div id="attackTimeline" class="timeline" aria-live="polite"></div>
        </div>
      </div>
    </section>
    <section class="editor-side">
      <div class="panel">
        <h2>Selection</h2>
        <label class="field">
          <span>Ability</span>
          <select id="abilitySelect" aria-label="Select ability"></select>
        </label>
        <label class="field">
          <span>Move</span>
          <select id="moveSelect" aria-label="Select move"></select>
        </label>
        <label class="field">
          <span>Attack</span>
          <select id="attackSelect" aria-label="Select attack"></select>
        </label>
        <div class="inline-controls">
          <button type="button" id="resetMove">Reset Move</button>
          <button type="button" id="resetAttack">Reset Attack</button>
        </div>
        <div class="status-banner" id="statusBanner" role="status" aria-live="polite"></div>
      </div>

      <div class="panel" id="weaponPanel">
        <h2>Weapons &amp; Combos</h2>
        <label class="field">
          <span>Equip Weapon</span>
          <select id="weaponSelect" aria-label="Equip weapon"></select>
        </label>
        <label class="field">
          <span>Combo</span>
          <select id="comboSelect" aria-label="Select combo"></select>
        </label>
        <div class="inline-controls">
          <button type="button" id="resetCombo">Reset Combo</button>
        </div>
      </div>

      <div class="panel" id="moveDetails">
        <h2>Move Details</h2>
        <label class="field">
          <span>Name</span>
          <input id="moveName" type="text" aria-label="Move name">
        </label>
        <label class="field">
          <span>Tags (comma separated)</span>
          <input id="moveTags" type="text" aria-label="Move tags">
        </label>
        <div class="sequence-actions">
          <strong>Durations (ms)</strong>
          <button type="button" id="normalizeDurations">Normalize</button>
        </div>
        <table class="sequence-table" aria-label="Move durations">
          <thead>
            <tr>
              <th scope="col">Phase</th>
              <th scope="col">Duration</th>
            </tr>
          </thead>
          <tbody id="durationRows"></tbody>
        </table>
        <label class="field">
          <span>Knockback Base</span>
          <input id="knockbackBase" type="number" step="1" aria-label="Knockback base">
        </label>
        <label class="field">
          <span>Cancel Window</span>
          <input id="cancelWindow" type="number" step="0.01" min="0" max="1" aria-label="Cancel window">
        </label>
      </div>

      <div class="panel" id="poseEditor">
        <h2>Pose Preview &amp; Editor</h2>
        <label class="field">
          <span>Fighter</span>
          <select id="poseFighterSelect" aria-label="Select fighter for pose preview"></select>
        </label>
        <label class="field">
          <span>Pose</span>
          <select id="poseKeySelect" aria-label="Select pose to preview"></select>
        </label>
        <div class="inline-controls">
          <button type="button" id="applyPoseChanges">Apply To Move</button>
          <button type="button" id="resetPoseChanges">Reset Pose</button>
        </div>
        <label class="field">
          <span>Pose JSON</span>
          <textarea id="poseJson" class="json-output" spellcheck="false" aria-label="Pose JSON"></textarea>
        </label>
        <p class="panel-hint">Changes apply to the active move draft. Copy updated JSON from the export panel when you're satisfied.</p>
      </div>

      <div class="panel" id="moveSequencePanel">
        <div class="sequence-actions">
          <h2 style="margin:0;">Move Sequence</h2>
          <button type="button" id="addMovePhase">Add Phase</button>
        </div>
        <table class="sequence-table" aria-label="Move sequence">
          <thead>
            <tr>
              <th scope="col">Pose Key</th>
              <th scope="col">Duration (ms)</th>
              <th scope="col">Strike?</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody id="moveSequence"></tbody>
        </table>
      </div>

      <div class="panel" id="attackDetails">
        <div class="sequence-actions">
          <h2 style="margin:0;">Attack Sequence</h2>
          <button type="button" id="addAttackStep">Add Step</button>
        </div>
        <table class="sequence-table" aria-label="Attack sequence">
          <thead>
            <tr>
              <th scope="col">Move</th>
              <th scope="col">Start (ms)</th>
              <th scope="col">Tags</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody id="attackSequence"></tbody>
        </table>
        <div class="sequence-actions">
          <strong>Attack Data</strong>
          <button type="button" id="addAttackTag">Add Tag</button>
        </div>
        <label class="field">
          <span>Name</span>
          <input id="attackName" type="text" aria-label="Attack name">
        </label>
        <label class="field">
          <span>Tags (comma separated)</span>
          <input id="attackTags" type="text" aria-label="Attack tags">
        </label>
        <div class="inline-controls">
          <label class="field" style="flex:1;">
            <span>Damage (Health)</span>
            <input id="attackDamageHealth" type="number" step="1" aria-label="Attack damage health">
          </label>
          <label class="field" style="flex:1;">
            <span>Stamina Cost</span>
            <input id="attackStamina" type="number" step="1" aria-label="Attack stamina cost">
          </label>
        </div>
        <label class="field">
          <span>Colliders (comma separated)</span>
          <input id="attackColliders" type="text" aria-label="Attack colliders">
        </label>
        <label class="field">
          <span>Use Weapon Colliders</span>
          <select id="attackUseWeaponColliders" aria-label="Use weapon colliders">
            <option value="auto">Auto</option>
            <option value="true">True</option>
            <option value="false">False</option>
          </select>
        </label>
      </div>

      <div class="panel" id="comboDetails">
        <div class="sequence-actions">
          <h2 style="margin:0;">Combo Sequence</h2>
          <button type="button" id="addComboStep">Add Step</button>
        </div>
        <label class="field">
          <span>Name</span>
          <input id="comboName" type="text" aria-label="Combo name">
        </label>
        <div class="inline-controls">
          <label class="field" style="flex:1;">
            <span>Weapon</span>
            <select id="comboWeapon" aria-label="Combo weapon"></select>
          </label>
          <label class="field" style="flex:1;">
            <span>Combo Window (ms)</span>
            <input id="comboWindow" type="number" step="10" min="0" aria-label="Combo window">
          </label>
        </div>
        <label class="field">
          <span>Type</span>
          <input id="comboType" type="text" aria-label="Combo type">
        </label>
        <table class="sequence-table" aria-label="Combo sequence">
          <thead>
            <tr>
              <th scope="col">Attack</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody id="comboSequence"></tbody>
        </table>
      </div>

      <div class="panel">
        <h2>Export</h2>
        <p class="status-banner">Copy updated JSON back into <code>docs/config/config.js</code> when you're ready.</p>
        <label class="field">
          <span>Move JSON</span>
          <textarea id="moveJson" class="json-output" spellcheck="false" aria-label="Move JSON"></textarea>
        </label>
        <label class="field">
          <span>Attack JSON</span>
          <textarea id="attackJson" class="json-output" spellcheck="false" aria-label="Attack JSON"></textarea>
        </label>
        <label class="field">
          <span>Combo JSON</span>
          <textarea id="comboJson" class="json-output" spellcheck="false" aria-label="Combo JSON"></textarea>
        </label>
        <div class="inline-controls">
          <button type="button" id="copyMoveJson">Copy Move JSON</button>
          <button type="button" id="copyAttackJson">Copy Attack JSON</button>
          <button type="button" id="copyComboJson">Copy Combo JSON</button>
          <button type="button" id="downloadJson">Download All</button>
        </div>
      </div>
    </section>
  </main>

  <script src="./config/config.js"></script>
  <script type="module" src="./js/animation-editor-app.js?v=1"></script>
</body>
</html>
